<div class="space-y-6">
    <section>
        <h2 class="text-lg font-semibold text-slate-700 mb-3">Sales Pipeline Overview</h2>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4" id="bd-kpi-container">
            </div>
    </section>
    <section>
        <h2 class="text-lg font-semibold text-slate-700 mb-3">Opportunity List</h2>
        <div class="card">
            <table class="w-full text-sm">
                <thead>
                    <tr class="border-b"><th class="text-left py-2">Opportunity</th><th class="text-left py-2">Client</th><th class="text-left py-2">Stage</th><th class="text-right py-2">Value</th></tr>
                </thead>
                <tbody id="bd-opp-body"></tbody>
            </table>
        </div>
    </section>
</div>

<script>
    window.pageInit = window.pageInit || {};
    window.pageInit.bd_dashboard = async (currentUser) => {
        console.log('Initializing BD Dashboard for:', currentUser.email);

        const kpiContainer = document.getElementById('bd-kpi-container');
        const oppBody = document.getElementById('bd-opp-body');

        const bdData = await api.getBdDashboardData();
        
        // Render KPIs
        kpiContainer.innerHTML = `
            <div class="card"><div class="text-sm text-slate-500">Pipeline Value</div><div class="kpi">฿${bdData.kpis.pipeline_value.toLocaleString()}</div></div>
            <div class="card"><div class="text-sm text-slate-500">Win Rate (QTD)</div><div class="kpi">${bdData.kpis.win_rate}%</div></div>
            <div class="card"><div class="text-sm text-slate-500">Proposals to Follow-Up</div><div class="kpi text-amber-600">${bdData.kpis.follow_ups}</div></div>
        `;

        // Render Opportunities
        oppBody.innerHTML = bdData.opportunities.map(opp => `
             <tr class="border-b hover:bg-slate-50">
                <td class="py-2 font-medium">${opp.name}</td>
                <td class="py-2 text-slate-600">${opp.client}</td>
                <td class="py-2"><span class="pill bg-sky-100 text-sky-700">${opp.stage}</span></td>
                <td class="py-2 text-right">฿${opp.value.toLocaleString()}</td>
            </tr>
        `).join('');
    };
</script>